import{r as e,j as s,B as a}from"./mui-BKRBi9c6.js";import{H as t,L as r,r as i}from"./vendor-CXfu1X1j.js";import{z as d}from"./index-DnSngz2F.js";import{A as o}from"./AuthenticatedLayout-B0v8q34p.js";import l from"./ProductSelection-CBvRpLNK.js";import n from"./CartSummary-CBWMnG1z.js";import m from"./CustomerSelection-XVJRrJsG.js";import p from"./PaymentShipping-ChJCYP4D.js";import c from"./OrderReview-D_cS7cOL.js";import u from"./OrderSummary-CXGCTxsE.js";import{X as h}from"./x-BWEyoRfZ.js";import{A as j}from"./arrow-left-CuUwxuCr.js";import{A as f}from"./arrow-right-DR_banmF.js";import"./Navbar-Cp-VK2OZ.js";import"./app-BLkjJg0m.js";import"./Sidebar-HDh619-e.js";import"./utils-Dp6QJa9S.js";import"./user-check-BkBYIEHF.js";import"./createLucideIcon-DTafSqzE.js";import"./package-BZ0coysK.js";import"./chevron-right-CHPI7KdZ.js";import"./chevron-left-CvYp6kNR.js";import"./user-D2E5EHqK.js";import"./card-DBmDQUNT.js";import"./badge-ClgcrdnI.js";import"./AsynchronousInput-DNmkCEvD.js";import"./Taka-HCVrmtu1.js";import"./triangle-alert-VcCWLTm0.js";import"./plus-avlLwFjE.js";import"./shopping-cart-CL8or4bS.js";import"./minus-BJgHQvPy.js";import"./CustomTextField-BTuAnPE3.js";import"./CustomSelectField-B-S7bTVB.js";import"./user-plus-DbESFwxq.js";import"./map-pin-CREN4_JN.js";import"./truck-COhtLTKw.js";import"./credit-card-E5W6JTNG.js";import"./file-text-3SkanPj_.js";import"./mail-HzjPNmz5.js";import"./dialog-Bvjd5N6n.js";import"./radix-BUpndTlX.js";import"./send-Ds1txHbe.js";import"./eye-C6XdZ-Tw.js";function x({products:x=[],customers:g=[],shippingCosts:N={}}){const[v,S]=e.useState(1),[y,C]=e.useState([]),[w,b]=e.useState(null),[_,A]=e.useState(!1),[k,I]=e.useState({fullName:"",phone:"",email:"",address:"",area:"inside_dhaka"}),[O,q]=e.useState({fullName:"",phone:"",email:"",address:"",area:"inside_dhaka"}),[D,F]=e.useState(!0),[P,M]=e.useState("cod"),[T,E]=e.useState("standard"),[L,$]=e.useState(""),[z,Q]=e.useState(""),[V,B]=e.useState(0),[H,J]=e.useState(!0),[K,R]=e.useState(!0),[U,W]=e.useState(!1),[X,Y]=e.useState(null),[Z,G]=e.useState(!1),[ee,se]=e.useState(!1),[ae,te]=e.useState(!1),re=(e,s)=>{C(y.map(a=>{if(a.id===e){const e=a.quantity+s;return e>0?{...a,quantity:e}:null}return a}).filter(e=>null!==e))},ie=e=>{C(y.filter(s=>s.id!==e))},de=y.reduce((e,s)=>e+(s.price||0)*s.quantity,0),oe=(()=>{if("free"===T)return 0;const e=O.area||"inside_dhaka";return N[e]?.[T]||0})(),le=de*V/100,ne=de-le+oe+0,me=y.length>0,pe=null!==w&&""!==O.fullName.trim()&&""!==O.phone.trim()&&""!==O.email.trim()&&""!==O.address.trim()&&""!==O.area.trim()&&(ue=O.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ue))&&(ce=O.phone,/^[\+]?[0-9\s\-\(\)]{10,}$/.test(ce.replace(/\s/g,"")));var ce,ue;const he=""!==P&&""!==T;return s.jsxs(o,{children:[s.jsx(t,{title:"Create Order"}),s.jsx("div",{className:"py-4",children:s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl leading-9 font-bold text-text-primary",children:"Create New Order"}),s.jsx("p",{className:"text-sm text-text-secondary mt-2",children:"Place an order on behalf of a customer"})]}),s.jsx(r,{href:route("admin.orders.index"),children:s.jsxs(a,{variant:"outline",className:"gap-2 hover:bg-destructive/10 hover:text-destructive hover:border-destructive/50 transition-all bg-transparent",children:[s.jsx(h,{className:"w-4 h-4"}),"Cancel"]})})]}),s.jsxs("div",{className:"flex items-center justify-between mb-10",children:[s.jsxs(a,{variant:"outline",onClick:()=>S(Math.max(1,v-1)),disabled:1===v,className:"gap-2 px-6 h-11 hover:bg-muted transition-all",children:[s.jsx(j,{className:"w-4 h-4"}),"Previous"]}),s.jsxs("div",{className:"text-sm font-semibold text-muted-foreground bg-muted px-6 py-2 rounded-full",children:["Step ",v," of ",4]}),v<4?s.jsxs(a,{onClick:()=>S(v+1),disabled:1===v&&!me||2===v&&!pe||3===v&&!he,className:"gap-2 px-6 h-11 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white shadow-lg shadow-emerald-500/30 transition-all disabled:opacity-50 disabled:shadow-none",children:["Next",s.jsx(f,{className:"w-4 h-4"})]}):s.jsx("div",{className:"w-28"})]}),s.jsxs("div",{className:"transition-all duration-300",children:[1===v&&s.jsxs("div",{className:"flex md:flex-row flex-col-reverse justify-center flex-wrap gap-8",children:[s.jsx("div",{className:"w-full md:max-w-[900px] space-y-6",children:s.jsx(l,{products:x,addToCart:e=>{const s=y.find(s=>s.id===e.id);C(s?y.map(s=>s.id===e.id?{...s,quantity:s.quantity+1}:s):[...y,{...e,quantity:1}])},cart:y})}),s.jsx("div",{className:"space-y-6 w-full md:max-w-[400px]",children:s.jsx(n,{cart:y,updateQuantity:re,removeFromCart:ie,subtotal:de})})]}),2===v&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsx(m,{customers:g,selectedCustomer:w,setSelectedCustomer:b,showNewCustomerForm:_,setShowNewCustomerForm:A,newCustomerData:k,setNewCustomerData:I,shippingAddress:O,setShippingAddress:q,handleCustomerSelect:e=>{if(b(e),e.defaultShippingAddress?(q({fullName:e.name,phone:e.phone,email:e.email,address:e.defaultShippingAddress.address_line,area:e.defaultShippingAddress.area}),se(!0),G(!1)):(q({fullName:e.name,phone:e.phone,email:e.email,address:"",area:"inside_dhaka"}),se(!1),G(!1)),e.addresses&&e.addresses.length>0){const s=e.addresses.find(e=>e.isDefault);s&&Y(s.id)}},handleCreateCustomer:()=>{const e={id:Date.now().toString(),name:k.fullName,email:k.email,phone:k.phone,address:k.address,type:"guest",totalOrders:0,totalSpent:0,lastOrderDate:(new Date).toISOString().split("T")[0],defaultShippingAddress:{address_line:k.address,area:k.area}};b(e),q({fullName:k.fullName,phone:k.phone,email:k.email,address:k.address,area:k.area}),A(!1),se(!0),I({fullName:"",phone:"",email:"",address:"",area:"inside_dhaka"})},handleNewCustomerClick:()=>{A(!_),_||(q({fullName:"",phone:"",email:"",address:"",area:"inside_dhaka"}),b(null),se(!1))},handleCreateNewAddress:()=>{G(!0),se(!1),Y(null),q({fullName:w?.name||"",phone:w?.phone||"",email:w?.email||"",address:"",area:"inside_dhaka"})},handleAddressSelect:e=>{if(w&&w.addresses){const s=w.addresses.find(s=>s.id==e);s&&(q({fullName:w.name,phone:w.phone,email:w.email,address:s.address_line,area:s.area}),se(!0),G(!1),Y(e))}},selectedAddress:X,isAddressFieldsDisabled:ee,setIsAddressFieldsDisabled:se,handleShippingAddressChange:(e,s)=>{const a={...O,[e]:s};q(a)}})}),s.jsx("div",{className:"space-y-6",children:s.jsx(n,{cart:y,updateQuantity:re,removeFromCart:ie,subtotal:de,isCompact:!0})})]}),3===v&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsx(p,{shippingMethod:T,setShippingMethod:E,paymentMethod:P,setPaymentMethod:M,orderNotes:L,setOrderNotes:$,shippingCosts:N,shippingAddress:O})}),s.jsx("div",{className:"space-y-6",children:s.jsx(u,{subtotal:de,discountAmount:V,discountValue:le,shippingCost:oe,tax:0,total:ne,isCompact:!0})})]}),4===v&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsx(c,{selectedCustomer:w,cart:y,shippingAddress:O,shippingMethod:T,paymentMethod:P,orderNotes:L,discountAmount:V,discountCode:z,sendConfirmationEmail:H,setSendConfirmationEmail:J,sendInvoice:K,setSendInvoice:R})}),s.jsx("div",{className:"space-y-6",children:s.jsx(u,{subtotal:de,discountAmount:V,discountValue:le,shippingCost:oe,tax:0,total:ne,selectedCustomer:w,cart:y,shippingAddress:O,showInvoicePreview:U,setShowInvoicePreview:W,handlePlaceOrder:()=>{const e="guest"===w?.type,s={full_name:O.fullName,phone:O.phone,email:O.email,address_line:O.address,area:O.area},a={full_name:O.fullName,phone:O.phone,email:O.email,address_line:O.address,area:O.area},t={user_id:e?null:w?.id||null,shipping_address:s,billing_address:a,items:y.map(e=>({product_id:e.productId,variant_id:e.variantId,quantity:e.quantity,price:e.price})),payment_method:P,shipping_method:T,notes:L,discount_code:z,discount_amount:V,send_confirmation_email:H,send_invoice:K,subtotal:de,shipping_cost:oe,discount_total:le,tax_total:0,total:ne};te(!0);const r=d.loading("Creating order...");i.post(route("admin.orders.store"),t,{onStart:()=>{},onSuccess:e=>{te(!1),d.dismiss(r),d.success("Order placed successfully!")},onError:e=>{if(te(!1),d.dismiss(r),e&&"object"==typeof e){const s=Object.values(e).flat();d.error(s.join(", "))}else d.error("Failed to place order. Please try again.")}})},isSubmitting:ae})})]})]})]})})})]})}export{x as default};
